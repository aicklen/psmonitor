<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>psmonitor: code/psmonitor/psmonitor.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">psmonitor
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Power supply voltage/current monitor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('psmonitor_8ino.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">psmonitor.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Monitor and display for dual adjustable power supplies with symmetric positive and negative outputs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="Adafruit__INA260_8h_source.html">Adafruit_INA260.h</a>&quot;</code><br />
<code>#include &lt;LiquidCrystal.h&gt;</code><br />
<code>#include &quot;<a class="el" href="globals_8h_source.html">globals.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="BuzzerTask_8h_source.html">BuzzerTask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="CalibrateTask_8h_source.html">CalibrateTask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MonitorTask_8h_source.html">MonitorTask.h</a>&quot;</code><br />
<code>#include &quot;Calibration.h&quot;</code><br />
</div>
<p><a href="psmonitor_8ino_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af8903d8eea3868940c60af887473b152"><td class="memItemLeft" align="right" valign="top"><a id="af8903d8eea3868940c60af887473b152"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RS</b>&#160;&#160;&#160;12</td></tr>
<tr class="separator:af8903d8eea3868940c60af887473b152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22e6626f2c98ed902f8ded47f6438c05"><td class="memItemLeft" align="right" valign="top"><a id="a22e6626f2c98ed902f8ded47f6438c05"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EN</b>&#160;&#160;&#160;11</td></tr>
<tr class="separator:a22e6626f2c98ed902f8ded47f6438c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7537ecd0f0af6ccc5b85d5df80f4aee7"><td class="memItemLeft" align="right" valign="top"><a id="a7537ecd0f0af6ccc5b85d5df80f4aee7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>D2</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a7537ecd0f0af6ccc5b85d5df80f4aee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea037e4c6e9187610b538bd6a34b8ff"><td class="memItemLeft" align="right" valign="top"><a id="afea037e4c6e9187610b538bd6a34b8ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>D3</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:afea037e4c6e9187610b538bd6a34b8ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9bb178282c3cb69740c94ba1e48fed"><td class="memItemLeft" align="right" valign="top"><a id="a3d9bb178282c3cb69740c94ba1e48fed"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>D4</b>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a3d9bb178282c3cb69740c94ba1e48fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ddd4183d444d6d128cbdbd6269e4e0c"><td class="memItemLeft" align="right" valign="top"><a id="a2ddd4183d444d6d128cbdbd6269e4e0c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>D5</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a2ddd4183d444d6d128cbdbd6269e4e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61d0981ed42df9e18211b273d22cfcd"><td class="memItemLeft" align="right" valign="top"><a id="ab61d0981ed42df9e18211b273d22cfcd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BUZZER_PIN</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ab61d0981ed42df9e18211b273d22cfcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2ad14f0789907024ac765711ffd3da"><td class="memItemLeft" align="right" valign="top"><a id="abc2ad14f0789907024ac765711ffd3da"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BUTTON_PIN</b>&#160;&#160;&#160;7</td></tr>
<tr class="separator:abc2ad14f0789907024ac765711ffd3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199e55c829920c767a3f1f42a6a7c1d8"><td class="memItemLeft" align="right" valign="top"><a id="a199e55c829920c767a3f1f42a6a7c1d8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MODE_NORMAL</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a199e55c829920c767a3f1f42a6a7c1d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe12ca5e671c24d97d5daa9f104b60fb"><td class="memItemLeft" align="right" valign="top"><a id="afe12ca5e671c24d97d5daa9f104b60fb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MODE_CALIBRATE</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:afe12ca5e671c24d97d5daa9f104b60fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e786cdb1a9f5712cc9d790d391a1d6"><td class="memItemLeft" align="right" valign="top"><a id="a70e786cdb1a9f5712cc9d790d391a1d6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MODE_TERMINATE</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a70e786cdb1a9f5712cc9d790d391a1d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5786e8ffbdd23efaa413501193766c1b"><td class="memItemLeft" align="right" valign="top"><a id="a5786e8ffbdd23efaa413501193766c1b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MONITOR_INTERVAL</b>&#160;&#160;&#160;200</td></tr>
<tr class="separator:a5786e8ffbdd23efaa413501193766c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d6b7d5e608a7cc73fed9e1124f3aa0"><td class="memItemLeft" align="right" valign="top"><a id="a03d6b7d5e608a7cc73fed9e1124f3aa0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MONITOR_POS_ADDR</b>&#160;&#160;&#160;0x40</td></tr>
<tr class="separator:a03d6b7d5e608a7cc73fed9e1124f3aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643b2b2fc32db3489ecfb5388be190f1"><td class="memItemLeft" align="right" valign="top"><a id="a643b2b2fc32db3489ecfb5388be190f1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MONITOR_NEG_ADDR</b>&#160;&#160;&#160;0x41</td></tr>
<tr class="separator:a643b2b2fc32db3489ecfb5388be190f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1242773f841e2955f1d73d975dbfa191"><td class="memItemLeft" align="right" valign="top"><a id="a1242773f841e2955f1d73d975dbfa191"></a>
LiquidCrystal&#160;</td><td class="memItemRight" valign="bottom"><b>lcd</b> (RS, EN, D2, D3, D4, D5)</td></tr>
<tr class="separator:a1242773f841e2955f1d73d975dbfa191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top"><a id="a4fc01d736fe50cf5b977f755b675f11d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="psmonitor_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the power supply monitor; runs once on powerup or reset. <br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top"><a id="afe461d27b9c48d5921c00d521181f12f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="psmonitor_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs continuously after setup; implements a simple non-preempting round-robin scheduler. <br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1ce200f8d1a532200cb616614cdc4c12"><td class="memItemLeft" align="right" valign="top"><a id="a1ce200f8d1a532200cb616614cdc4c12"></a>
byte&#160;</td><td class="memItemRight" valign="bottom"><b>previous_button_state</b> = HIGH</td></tr>
<tr class="separator:a1ce200f8d1a532200cb616614cdc4c12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1ef53d558f4d18e836990bbe55271a"><td class="memItemLeft" align="right" valign="top"><a id="aae1ef53d558f4d18e836990bbe55271a"></a>
byte&#160;</td><td class="memItemRight" valign="bottom"><b>currentMode</b> = MODE_NORMAL</td></tr>
<tr class="separator:aae1ef53d558f4d18e836990bbe55271a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a656411f9da80530053c2cc615d0c8a56"><td class="memItemLeft" align="right" valign="top"><a id="a656411f9da80530053c2cc615d0c8a56"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="psmonitor_8ino.html#a656411f9da80530053c2cc615d0c8a56">string_buf</a> [17]</td></tr>
<tr class="memdesc:a656411f9da80530053c2cc615d0c8a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer used to construct strings displayed on LCD monitor. <br /></td></tr>
<tr class="separator:a656411f9da80530053c2cc615d0c8a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Monitor and display for dual adjustable power supplies with symmetric positive and negative outputs. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2024 Gregory Aicklen. Licensed under the MIT License</dd></dl>
<p>This sketch implements the firmware for a voltage and current monitor that can be retrofitted to an existing symmetric, dual output power supply (i.e. a supply with positive and negative outputs of the same magnitude). The firmware is for a custom hardware design.</p>
<p>Normally, the sketch will take current and voltage measurements for both positive and negative supplies, correct for measurement errors, and display on the LCD. If turned on while holding down the mute button, the firmware will go into calibration mode where the user will be directed to set specific voltages and currents at the power supply outputs using a trusted DMM; corrections for measurement errors will be computed and stored to EEPROM for subsequent use in normal mode.</p>
<p>This firmware provides an audible warning if any output voltage or current exceeds the maximum specifications for the supply. The warning can be muted by pressing the mute button once, and unmuted by pressing the mute button again. </p>

<p class="definition">Definition in file <a class="el" href="psmonitor_8ino_source.html">psmonitor.ino</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_13eaa5f1e417dcbd48f3ae56ada896da.html">psmonitor</a></li><li class="navelem"><a class="el" href="psmonitor_8ino.html">psmonitor.ino</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
