<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>psmonitor: MonitorTask.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">psmonitor<span id="projectnumber">&#160;0.9</span>
   </div>
   <div id="projectbrief">Power supply voltage/current monitor</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_monitor_task_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">MonitorTask.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements a MonitorTask that reads voltage and current from INA260 sensors and displays on LCD.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_adafruit___i_n_a260_8h_source.html">Adafruit_INA260.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_monitor_task_8h_source.html">MonitorTask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_buzzer_task_8h_source.html">BuzzerTask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globals_8h_source.html">globals.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="limits_8h_source.html">limits.h</a>&quot;</code><br />
</div>
<p><a href="_monitor_task_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a77d7a3a3003249a4817b34204759a479" id="r_a77d7a3a3003249a4817b34204759a479"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77d7a3a3003249a4817b34204759a479">OVER_RANGE_BEEP_N</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a77d7a3a3003249a4817b34204759a479"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c2a3bea5eba025902cb5014fce85632" id="r_a7c2a3bea5eba025902cb5014fce85632"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c2a3bea5eba025902cb5014fce85632">MonitorTask::nearest10</a> (int16_t value)</td></tr>
<tr class="memdesc:a7c2a3bea5eba025902cb5014fce85632"><td class="mdescLeft">&#160;</td><td class="mdescRight">Round integer to nearest multiple of 10.  <br /></td></tr>
<tr class="separator:a7c2a3bea5eba025902cb5014fce85632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84237809d293d7cac6006ad3290a4ac" id="r_ac84237809d293d7cac6006ad3290a4ac"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac84237809d293d7cac6006ad3290a4ac">MonitorTask::generateVoltageString</a> (int16_t value)</td></tr>
<tr class="memdesc:ac84237809d293d7cac6006ad3290a4ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a voltage string from the provided integer value.  <br /></td></tr>
<tr class="separator:ac84237809d293d7cac6006ad3290a4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5354b0cc977afe61e47b082f08dbcb80" id="r_a5354b0cc977afe61e47b082f08dbcb80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5354b0cc977afe61e47b082f08dbcb80">MonitorTask::setup</a> (unsigned long interval, uint8_t pos_addr, uint8_t neg_addr, LiquidCrystal *display)</td></tr>
<tr class="memdesc:a5354b0cc977afe61e47b082f08dbcb80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the Monitor task basic operating parameters and LCD display.  <br /></td></tr>
<tr class="separator:a5354b0cc977afe61e47b082f08dbcb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a042ed723625dbcff52d8cb8def507736" id="r_a042ed723625dbcff52d8cb8def507736"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a042ed723625dbcff52d8cb8def507736">MonitorTask::communicationOK</a> ()</td></tr>
<tr class="memdesc:a042ed723625dbcff52d8cb8def507736"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the current state of communications with the INA260 sensors.  <br /></td></tr>
<tr class="separator:a042ed723625dbcff52d8cb8def507736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a03c93a2c529dbc728e30b0fa1ce0d4" id="r_a4a03c93a2c529dbc728e30b0fa1ce0d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a03c93a2c529dbc728e30b0fa1ce0d4">MonitorTask::setAveragingCount</a> (<a class="el" href="_adafruit___i_n_a260_8h.html#ae48e22b52d5df9c826bcbdd9dce59bb7">INA260_AveragingCount</a> count)</td></tr>
<tr class="memdesc:a4a03c93a2c529dbc728e30b0fa1ce0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of samples to average.  <br /></td></tr>
<tr class="separator:a4a03c93a2c529dbc728e30b0fa1ce0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7ed68059744d001e782b27f26797d6" id="r_a3c7ed68059744d001e782b27f26797d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c7ed68059744d001e782b27f26797d6">MonitorTask::setConversionTime</a> (<a class="el" href="_adafruit___i_n_a260_8h.html#afef2d924a64e9d6aae752de2321424e9">INA260_ConversionTime</a> conv)</td></tr>
<tr class="memdesc:a3c7ed68059744d001e782b27f26797d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time over which to measure the current and bus voltage samples.  <br /></td></tr>
<tr class="separator:a3c7ed68059744d001e782b27f26797d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa848694eaaf58e5cb9c1d8646bebd0ed" id="r_aa848694eaaf58e5cb9c1d8646bebd0ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa848694eaaf58e5cb9c1d8646bebd0ed">MonitorTask::update</a> ()</td></tr>
<tr class="memdesc:aa848694eaaf58e5cb9c1d8646bebd0ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called each time through the scheduling loop to implement monitoring.  <br /></td></tr>
<tr class="separator:aa848694eaaf58e5cb9c1d8646bebd0ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc22bc7d529ec732e5f43a348e577f96" id="r_acc22bc7d529ec732e5f43a348e577f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc22bc7d529ec732e5f43a348e577f96">MonitorTask::getRawValues</a> (void)</td></tr>
<tr class="memdesc:acc22bc7d529ec732e5f43a348e577f96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and returns the raw, unscaled and uncorrected ADC values for all measurements.  <br /></td></tr>
<tr class="separator:acc22bc7d529ec732e5f43a348e577f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac248e96554fff909929ac66ae892d026" id="r_ac248e96554fff909929ac66ae892d026"><td class="memItemLeft" align="right" valign="top">int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac248e96554fff909929ac66ae892d026">readings</a> [4]</td></tr>
<tr class="memdesc:ac248e96554fff909929ac66ae892d026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of integers holding a set of current and voltage measurements.  <br /></td></tr>
<tr class="separator:ac248e96554fff909929ac66ae892d026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23285978e1523aa7fcf0d70f45fc6f8" id="r_ab23285978e1523aa7fcf0d70f45fc6f8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab23285978e1523aa7fcf0d70f45fc6f8">MonitorTask::commOKFlag</a> = false</td></tr>
<tr class="separator:ab23285978e1523aa7fcf0d70f45fc6f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ecf5f1669b9319d2fd72e385fd2e03" id="r_a87ecf5f1669b9319d2fd72e385fd2e03"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87ecf5f1669b9319d2fd72e385fd2e03">MonitorTask::startedFlag</a> = false</td></tr>
<tr class="separator:a87ecf5f1669b9319d2fd72e385fd2e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee713c780fb5d1ae301e4cf1ab2bc158" id="r_aee713c780fb5d1ae301e4cf1ab2bc158"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee713c780fb5d1ae301e4cf1ab2bc158">MonitorTask::taskInterval</a> = 250</td></tr>
<tr class="separator:aee713c780fb5d1ae301e4cf1ab2bc158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b767a89a6c28b80906c152fe3e890c" id="r_ab8b767a89a6c28b80906c152fe3e890c"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab8b767a89a6c28b80906c152fe3e890c">MonitorTask::rolloverThreshold</a> = 2500</td></tr>
<tr class="separator:ab8b767a89a6c28b80906c152fe3e890c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a085a321cc1136bc5a137d9c2dd954b7b" id="r_a085a321cc1136bc5a137d9c2dd954b7b"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a085a321cc1136bc5a137d9c2dd954b7b">MonitorTask::currentTime</a></td></tr>
<tr class="separator:a085a321cc1136bc5a137d9c2dd954b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66eba45fb72c3ee0e57a9ff3a383fa92" id="r_a66eba45fb72c3ee0e57a9ff3a383fa92"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66eba45fb72c3ee0e57a9ff3a383fa92">MonitorTask::targetTime</a> = 0</td></tr>
<tr class="separator:a66eba45fb72c3ee0e57a9ff3a383fa92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97809dd622d90ee38d170940a59e6d84" id="r_a97809dd622d90ee38d170940a59e6d84"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97809dd622d90ee38d170940a59e6d84">MonitorTask::beep_count</a> = 0</td></tr>
<tr class="separator:a97809dd622d90ee38d170940a59e6d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b507f770447cf575a4bdd6e95094cf7" id="r_a6b507f770447cf575a4bdd6e95094cf7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b507f770447cf575a4bdd6e95094cf7">MonitorTask::ina260Pos</a> = <a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>()</td></tr>
<tr class="separator:a6b507f770447cf575a4bdd6e95094cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa49238dc8f5bf6ad1fdd8cc96bcd193d" id="r_aa49238dc8f5bf6ad1fdd8cc96bcd193d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa49238dc8f5bf6ad1fdd8cc96bcd193d">MonitorTask::ina260Neg</a> = <a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>()</td></tr>
<tr class="separator:aa49238dc8f5bf6ad1fdd8cc96bcd193d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b123fb1caa4d31d5ab5bd8e4b377036" id="r_a6b123fb1caa4d31d5ab5bd8e4b377036"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b123fb1caa4d31d5ab5bd8e4b377036">MonitorTask::alert</a> [4]</td></tr>
<tr class="separator:a6b123fb1caa4d31d5ab5bd8e4b377036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48dff4b7d19d14087901427fc9c222bd" id="r_a48dff4b7d19d14087901427fc9c222bd"><td class="memItemLeft" align="right" valign="top">LiquidCrystal *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48dff4b7d19d14087901427fc9c222bd">MonitorTask::lcd</a></td></tr>
<tr class="separator:a48dff4b7d19d14087901427fc9c222bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements a MonitorTask that reads voltage and current from INA260 sensors and displays on LCD. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2024 Gregory Aicklen. Licensed under GPL-3.0-or-later</dd></dl>
<p>Implements a MonitorTask that measures sets of voltage and current values from the ADCs of two INA260 voltage/current sensors, corrects for gain and offset errors using corrections stored in EEPROM, and displays both positive and negative supply voltages and currents on the LCD display.</p>
<p>To use the Monitor task:</p><ul>
<li><a class="el" href="#a5354b0cc977afe61e47b082f08dbcb80" title="Configures the Monitor task basic operating parameters and LCD display.">MonitorTask::setup()</a> - setup the basic task parameters and establish connection to INA260 sensors</li>
<li><a class="el" href="#a042ed723625dbcff52d8cb8def507736" title="Gets the current state of communications with the INA260 sensors.">MonitorTask::communicationOK()</a> - check that communication with INA260s has been established</li>
<li><a class="el" href="#a4a03c93a2c529dbc728e30b0fa1ce0d4" title="Set the number of samples to average.">MonitorTask::setAveragingCount()</a> - set number of samples taken and averaged for each measurement; optional</li>
<li><a class="el" href="#a3c7ed68059744d001e782b27f26797d6" title="Set the time over which to measure the current and bus voltage samples.">MonitorTask::setConversionTime()</a> - set ADC conversion time per sample for each measurement; optional</li>
<li><a class="el" href="#aa848694eaaf58e5cb9c1d8646bebd0ed" title="Called each time through the scheduling loop to implement monitoring.">MonitorTask::update()</a> - run the monitor task; call once each time through scheduler</li>
<li><a class="el" href="#acc22bc7d529ec732e5f43a348e577f96" title="Reads and returns the raw, unscaled and uncorrected ADC values for all measurements.">MonitorTask::getRawValues()</a> - call anytime after setup to retrieve raw, unscaled and uncorrected values from sensors</li>
</ul>
<p>Intended to be run by a simple, non-preemptive round robin scheduler, where each task is responsible for relinquishing control; this code is <em>not threadsafe</em> and must not be interrupted. </p>

<p class="definition">Definition in file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a77d7a3a3003249a4817b34204759a479" name="a77d7a3a3003249a4817b34204759a479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77d7a3a3003249a4817b34204759a479">&#9670;&#160;</a></span>OVER_RANGE_BEEP_N</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OVER_RANGE_BEEP_N&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00040">40</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a042ed723625dbcff52d8cb8def507736" name="a042ed723625dbcff52d8cb8def507736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a042ed723625dbcff52d8cb8def507736">&#9670;&#160;</a></span>communicationOK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MonitorTask::communicationOK </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the current state of communications with the INA260 sensors. </p>
<dl class="section return"><dt>Returns</dt><dd>State of communication with INA260 sensors </dd></dl>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00115">115</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="ac84237809d293d7cac6006ad3290a4ac" name="ac84237809d293d7cac6006ad3290a4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac84237809d293d7cac6006ad3290a4ac">&#9670;&#160;</a></span>generateVoltageString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * MonitorTask::generateVoltageString </td>
          <td>(</td>
          <td class="paramtype">int16_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a voltage string from the provided integer value. </p>
<p>Generate voltage string from provided value. Takes value in millivolts and presents as decimal volts with precision to hundredths of a volt.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>Integer value of voltage in millivolts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String representing decimal volts to thousandths of a volt </dd></dl>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00262">262</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="acc22bc7d529ec732e5f43a348e577f96" name="acc22bc7d529ec732e5f43a348e577f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc22bc7d529ec732e5f43a348e577f96">&#9670;&#160;</a></span>getRawValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MonitorTask::getRawValues </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and returns the raw, unscaled and uncorrected ADC values for all measurements. </p>
<p>Reads and returns the raw, unscaled and uncorrected ADC values for all measurements.</p>
<p>This function supports the Calibrate task and is safe to call after setup but when the Monitor task is not being scheduled (i.e. during calibration). Note that the global readings array is used here for raw readings, so this must not be called when the monitor task is being scheduled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">readings[]</td><td>Returns results in global array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00229">229</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a7c2a3bea5eba025902cb5014fce85632" name="a7c2a3bea5eba025902cb5014fce85632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2a3bea5eba025902cb5014fce85632">&#9670;&#160;</a></span>nearest10()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t MonitorTask::nearest10 </td>
          <td>(</td>
          <td class="paramtype">int16_t</td>          <td class="paramname"><span class="paramname"><em>value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Round integer to nearest multiple of 10. </p>
<dl class="section return"><dt>Returns</dt><dd>Rounded integer </dd></dl>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00244">244</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a4a03c93a2c529dbc728e30b0fa1ce0d4" name="a4a03c93a2c529dbc728e30b0fa1ce0d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a03c93a2c529dbc728e30b0fa1ce0d4">&#9670;&#160;</a></span>setAveragingCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MonitorTask::setAveragingCount </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_adafruit___i_n_a260_8h.html#ae48e22b52d5df9c826bcbdd9dce59bb7">INA260_AveragingCount</a></td>          <td class="paramname"><span class="paramname"><em>count</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the number of samples to average. </p>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00123">123</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a3c7ed68059744d001e782b27f26797d6" name="a3c7ed68059744d001e782b27f26797d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7ed68059744d001e782b27f26797d6">&#9670;&#160;</a></span>setConversionTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MonitorTask::setConversionTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_adafruit___i_n_a260_8h.html#afef2d924a64e9d6aae752de2321424e9">INA260_ConversionTime</a></td>          <td class="paramname"><span class="paramname"><em>conv</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the time over which to measure the current and bus voltage samples. </p>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00132">132</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a5354b0cc977afe61e47b082f08dbcb80" name="a5354b0cc977afe61e47b082f08dbcb80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5354b0cc977afe61e47b082f08dbcb80">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MonitorTask::setup </td>
          <td>(</td>
          <td class="paramtype">unsigned long</td>          <td class="paramname"><span class="paramname"><em>interval</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>pos_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>neg_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LiquidCrystal *</td>          <td class="paramname"><span class="paramname"><em>display</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the Monitor task basic operating parameters and LCD display. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">interval</td><td>Time in milliseconds between task runs </td></tr>
    <tr><td class="paramname">pos_addr</td><td>I2C address of positive voltage/current INA260 sensor </td></tr>
    <tr><td class="paramname">neg_addr</td><td>I2C address of negative voltage/current INA260 sensor </td></tr>
    <tr><td class="paramname">display</td><td>Pointer to the LCD display object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00089">89</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="aa848694eaaf58e5cb9c1d8646bebd0ed" name="aa848694eaaf58e5cb9c1d8646bebd0ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa848694eaaf58e5cb9c1d8646bebd0ed">&#9670;&#160;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MonitorTask::update </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called each time through the scheduling loop to implement monitoring. </p>
<p>Implements the MonitorTask main function to display current and voltage for both positive and negative supplies. Runs whenever the scheduler transfers control to the MonitorTask and determines if it is time to run; if not time to run, immediately relinquishes control back to the scheduler. </p>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00147">147</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6b123fb1caa4d31d5ab5bd8e4b377036" name="a6b123fb1caa4d31d5ab5bd8e4b377036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b123fb1caa4d31d5ab5bd8e4b377036">&#9670;&#160;</a></span>alert</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MonitorTask::alert[4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00075">75</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a97809dd622d90ee38d170940a59e6d84" name="a97809dd622d90ee38d170940a59e6d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97809dd622d90ee38d170940a59e6d84">&#9670;&#160;</a></span>beep_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t MonitorTask::beep_count = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00068">68</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="ab23285978e1523aa7fcf0d70f45fc6f8" name="ab23285978e1523aa7fcf0d70f45fc6f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab23285978e1523aa7fcf0d70f45fc6f8">&#9670;&#160;</a></span>commOKFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MonitorTask::commOKFlag = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00058">58</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a085a321cc1136bc5a137d9c2dd954b7b" name="a085a321cc1136bc5a137d9c2dd954b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a085a321cc1136bc5a137d9c2dd954b7b">&#9670;&#160;</a></span>currentTime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long MonitorTask::currentTime</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00064">64</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="aa49238dc8f5bf6ad1fdd8cc96bcd193d" name="aa49238dc8f5bf6ad1fdd8cc96bcd193d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa49238dc8f5bf6ad1fdd8cc96bcd193d">&#9670;&#160;</a></span>ina260Neg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a> MonitorTask::ina260Neg = <a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00072">72</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a6b507f770447cf575a4bdd6e95094cf7" name="a6b507f770447cf575a4bdd6e95094cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b507f770447cf575a4bdd6e95094cf7">&#9670;&#160;</a></span>ina260Pos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a> MonitorTask::ina260Pos = <a class="el" href="class_adafruit___i_n_a260.html">Adafruit_INA260</a>()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00071">71</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a48dff4b7d19d14087901427fc9c222bd" name="a48dff4b7d19d14087901427fc9c222bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48dff4b7d19d14087901427fc9c222bd">&#9670;&#160;</a></span>lcd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LiquidCrystal* MonitorTask::lcd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00078">78</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="ac248e96554fff909929ac66ae892d026" name="ac248e96554fff909929ac66ae892d026"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac248e96554fff909929ac66ae892d026">&#9670;&#160;</a></span>readings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t readings[4]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array of integers holding a set of current and voltage measurements. </p>

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00049">49</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="ab8b767a89a6c28b80906c152fe3e890c" name="ab8b767a89a6c28b80906c152fe3e890c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b767a89a6c28b80906c152fe3e890c">&#9670;&#160;</a></span>rolloverThreshold</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long MonitorTask::rolloverThreshold = 2500</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00063">63</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a87ecf5f1669b9319d2fd72e385fd2e03" name="a87ecf5f1669b9319d2fd72e385fd2e03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87ecf5f1669b9319d2fd72e385fd2e03">&#9670;&#160;</a></span>startedFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MonitorTask::startedFlag = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00059">59</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="a66eba45fb72c3ee0e57a9ff3a383fa92" name="a66eba45fb72c3ee0e57a9ff3a383fa92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66eba45fb72c3ee0e57a9ff3a383fa92">&#9670;&#160;</a></span>targetTime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long MonitorTask::targetTime = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00065">65</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
<a id="aee713c780fb5d1ae301e4cf1ab2bc158" name="aee713c780fb5d1ae301e4cf1ab2bc158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee713c780fb5d1ae301e4cf1ab2bc158">&#9670;&#160;</a></span>taskInterval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long MonitorTask::taskInterval = 250</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_monitor_task_8cpp_source.html#l00062">62</a> of file <a class="el" href="_monitor_task_8cpp_source.html">MonitorTask.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_monitor_task_8cpp.html">MonitorTask.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
